import{aI as x,a5 as ee,B as le,g as ae,r as Q,c as ue,b0 as te,A as oe,aE as ne,h as q,Q as C,d as O,aW as M,aX as D,R as u,S as d,U as n,a4 as B,f as i,$ as se,Y as F,ag as R,aw as k,b1 as de,a2 as A,aA as Y,V as b,ay as m,W as I,au as v,F as w,av as P,w as ie,X as K}from"./index-ClVGVZQa.js";import{b as _,c as h,a as L,Q as j}from"./QList-CwzcxbNU.js";import{a as re,b as fe,Q as ce,c as N}from"./QExpansionItem-DfAK4xB-.js";import{C as ve,S as $}from"./use-quasar-BL9sQpOz.js";import{Q as pe}from"./QMenu-BD6ZY1mC.js";const ye=x("survey",{state:()=>({survey:null,isPageLoaded:!1}),actions:{async loadPage(){this.survey=await ee.getSurvey(),this.isPageLoaded=!0}}}),me=ye;function U(e,o=new WeakMap){if(Object(e)!==e)return e;if(o.has(e))return o.get(e);const l=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const s=e.valueOf();if(Object(s)!==s){const t=new e.constructor(s);return o.set(e,t),t}}return o.set(e,l),e instanceof Set?e.forEach(s=>{l.add(U(s,o))}):e instanceof Map&&e.forEach((s,t)=>{l.set(t,U(s,o))}),Object.assign(l,...Object.keys(e).map(s=>({[s]:U(e[s],o)})))}const Ve=le({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:o,emit:l}){const{proxy:s}=ae(),{$q:t}=s,a=Q(null),r=Q(""),f=Q("");let p=!1;const c=ue(()=>te({initialValue:r.value,validate:e.validate,set:y,cancel:S,updatePosition:g},"value",()=>f.value,V=>{f.value=V}));function y(){e.validate(f.value)!==!1&&(E()===!0&&(l("save",f.value,r.value),l("update:modelValue",f.value)),H())}function S(){E()===!0&&l("cancel",f.value,r.value),H()}function g(){oe(()=>{a.value.updatePosition()})}function E(){return ne(f.value,r.value)===!1}function H(){p=!0,a.value.hide()}function z(){p=!1,r.value=U(e.modelValue),f.value=U(e.modelValue),l("beforeShow")}function X(){l("show")}function G(){p===!1&&E()===!0&&(e.autoSave===!0&&e.validate(f.value)===!0?(l("save",f.value,r.value),l("update:modelValue",f.value)):l("cancel",f.value,r.value)),l("beforeHide")}function J(){l("hide")}function Z(){const V=o.default!==void 0?[].concat(o.default(c.value)):[];return e.title&&V.unshift(q("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&V.push(q("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[q(C,{flat:!0,color:e.color,label:e.labelCancel||t.lang.label.cancel,onClick:S}),q(C,{flat:!0,color:e.color,label:e.labelSet||t.lang.label.set,onClick:y})])),V}return Object.assign(s,{set:y,cancel:S,show(V){a.value!==null&&a.value.show(V)},hide(V){a.value!==null&&a.value.hide(V)},updatePosition:g}),()=>{if(e.disable!==!0)return q(pe,{ref:a,class:"q-popup-edit",cover:e.cover,onBeforeShow:z,onShow:X,onBeforeHide:G,onHide:J,onEscapeKey:S},Z)}}}),be={class:"row items-center justify-end"},ke=O({__name:"SurveyViewPopup",props:M({field:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const o=D(e,"modelValue");return(l,s)=>(u(),d(Ve,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=t=>o.value=t),cover:!1,offset:[0,10],"label-set":"Сохранить","label-cancel":"Отменить",buttons:""},{default:n(t=>[l.field.type==="time"?(u(),d(B,{key:0,modelValue:t.value,"onUpdate:modelValue":a=>t.value=a,rules:["time"],mask:"time",filled:""},{append:n(()=>[i(se,{name:"access_time",class:"cursor-pointer"},{default:n(()=>[i(re,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[i(fe,{modelValue:t.value,"onUpdate:modelValue":a=>t.value=a,color:"secondary"},{default:n(()=>[F("div",be,[R(i(C,{label:"Закрыть","no-caps":"",flat:""},null,512),[[ve]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):k("",!0),l.field.type==="text"?(u(),d(B,{key:1,modelValue:t.value,"onUpdate:modelValue":a=>t.value=a,dense:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])):k("",!0),l.field.type==="number"?(u(),d(B,{key:2,modelValue:t.value,"onUpdate:modelValue":a=>t.value=a,onKeyup:de(t.set,["enter"]),type:"number",dense:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):k("",!0),l.field.type==="select"?(u(),d(ce,{key:3,modelValue:t.value,"onUpdate:modelValue":a=>t.value=a,options:l.field.options,dense:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue","options"])):k("",!0)]),_:1},8,["modelValue"]))}}),T=A(ke,[["__file","SurveyViewPopup.vue"]]),Se=O({__name:"SurveyViewItem",props:M({field:{}},{modelValue:{default:()=>({})},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const o=D(e,"modelValue");return(l,s)=>l.field.type!=="groups"?R((u(),d(L,{key:0,clickable:""},{default:n(()=>[i(_,null,{default:n(()=>[i(h,null,{default:n(()=>[b(m(l.field.label),1)]),_:1}),l.field.type!=="info"&&o.value[l.field.key]?(u(),d(h,{key:0,caption:""},{default:n(()=>[b(m(o.value[l.field.key]),1)]),_:1})):(u(),d(h,{key:1,caption:""},{default:n(()=>[b(m(I($)[l.field.type])+" "+m(l.field.type==="select"?`(${l.field.options.join(", ")})`:""),1)]),_:1}))]),_:1}),l.field.type!=="info"&&o.value[l.field.key]?(u(),d(_,{key:0,side:""},{default:n(()=>[i(C,{flat:"",round:"",icon:"edit",color:"info",size:"sm"}),i(T,{modelValue:o.value[l.field.key],"onUpdate:modelValue":s[0]||(s[0]=t=>o.value[l.field.key]=t),field:l.field},null,8,["modelValue","field"])]),_:1})):(u(),d(_,{key:1,side:""},{default:n(()=>[b(m(l.field.type!=="info"&&l.field.required?"Обязательное":"Необязательное"),1)]),_:1}))]),_:1})),[[Y]]):(u(),d(N,{key:1,label:l.field.label,caption:I($)[l.field.type],"default-opened":""},{default:n(()=>[(u(!0),v(w,null,P(l.field.groups,t=>(u(),d(N,{key:t.label,label:t.label,"header-inset-level":.3,"content-inset-level":.6},{default:n(()=>[(u(!0),v(w,null,P(t.fields,a=>(u(),d(L,{key:a.label},{default:n(()=>[i(_,null,{default:n(()=>[i(h,null,{default:n(()=>[b(m(a.label),1)]),_:2},1024),a.type!=="info"&&o.value[a.key]?(u(),d(h,{key:0,caption:""},{default:n(()=>[b(m(o.value[a.key]),1)]),_:2},1024)):(u(),d(h,{key:1,caption:""},{default:n(()=>[b(m(I($)[a.type])+" "+m(a.type==="select"?`(${a.options.join(", ")})`:""),1)]),_:2},1024))]),_:2},1024),a.type!=="info"&&o.value[a.key]?(u(),d(_,{key:0,side:""},{default:n(()=>[i(C,{flat:"",round:"",icon:"edit",color:"info",size:"sm"}),i(T,{modelValue:o.value[a.key],"onUpdate:modelValue":r=>o.value[a.key]=r,field:a},null,8,["modelValue","onUpdate:modelValue","field"])]),_:2},1024)):(u(),d(_,{key:1,side:""},{default:n(()=>[b(m(a.type==="info"?a.value:a.required?"Обязательное":"Необязательное"),1)]),_:2},1024))]),_:2},1024))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["label","caption"]))}}),W=A(Se,[["__file","SurveyViewItem.vue"]]),we={class:"card-container column"},_e=F("p",{class:"card-caption text-uppercase q-pl-md q-mb-sm"},"Базовые данные",-1),ge={key:0,class:"card-caption q-pl-md q-mt-sm"},he=F("p",{class:"card-caption text-uppercase q-pl-md q-mt-lg q-mb-sm"}," Дополнительная информация ",-1),qe={key:1,class:"text-center"},Qe=O({__name:"SurveyViewMode",props:M({fullfilledSurvey:{default:null}},{modelValue:{type:Boolean,required:!1},modelModifiers:{}}),emits:M(["answersChange"],["update:modelValue"]),setup(e,{emit:o}){const l=me(),s=e,t=o,a=Q(s.fullfilledSurvey?.survey||l.survey),r=Q(s.fullfilledSurvey?.answers?.reduce((p,c)=>({...p,[c.key]:c.value}),{})||{}),f=D(e,"modelValue");return ie(()=>r.value,p=>{t("answersChange",p)},{deep:!0}),(p,c)=>(u(),v("div",we,[a.value?(u(),v(w,{key:0},[_e,i(j,{class:"bg-secondary border-radius-8 overflow-hidden"},{default:n(()=>[(u(!0),v(w,null,P(a.value.mainFields,(y,S)=>(u(),v(w,{key:y.key},[S?(u(),d(K,{key:0})):k("",!0),i(W,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=g=>r.value=g),field:y},null,8,["modelValue","field"])],64))),128))]),_:1}),p.fullfilledSurvey?k("",!0):(u(),v("p",ge," Данные поля нельзя редактировать самостоятельно. ")),a.value.addFields.length>0?(u(),v(w,{key:1},[he,i(j,{class:"bg-secondary border-radius-8 overflow-hidden"},{default:n(()=>[(u(!0),v(w,null,P(a.value.addFields,(y,S)=>(u(),v(w,{key:y.key},[S?(u(),d(K,{key:0})):k("",!0),i(W,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=g=>r.value=g),field:y},null,8,["modelValue","field"])],64))),128))]),_:1}),p.fullfilledSurvey?k("",!0):(u(),d(j,{key:0,class:"card-container q-mt-lg bg-secondary border-radius-8 overflow-hidden"},{default:n(()=>[R((u(),d(L,{onClick:c[2]||(c[2]=y=>f.value=!f.value),class:"flex items-center text-info text-center",clickable:""},{default:n(()=>[i(_,null,{default:n(()=>[b(" Редактировать ")]),_:1})]),_:1})),[[Y]])]),_:1}))],64)):k("",!0)],64)):(u(),v("h5",qe," Данные анкеты остутствуют или произошла ошибка их получения "))]))}}),Be=A(Qe,[["__file","SurveyViewMode.vue"]]);export{Be as S,me as u};
