import{d as S,r as q,R as n,S as c,U as o,Y as h,f as e,_ as N,ay as _,ag as $,Q as v,X as M,W as g,au as Q,F as E,a4 as B,aV as Z,aw as C,Z as U,as as D,V as r,at as z,a2 as O,av as R,az as F,aA as te,a5 as ae,o as se,E as le}from"./index-ClVGVZQa.js";import{Q as G,a as I,b as V,c as k}from"./QList-CwzcxbNU.js";import{Q as ne,c as ie}from"./QExpansionItem-DfAK4xB-.js";import{Q as re}from"./QPage-D-MMIN23.js";import{u as W,Q as j,C as K,a as J,i as P,I as ue}from"./use-quasar-BL9sQpOz.js";import{Q as ee}from"./QForm-BVwyUcln.js";import{u as L,T as A}from"./useWorkoutStore-SnJQJqI9.js";import"./QMenu-BD6ZY1mC.js";import"./format-C30SLclc.js";import"./rtl-DFPa-2ov.js";const de={class:"card-container card-container--sm bg-dark q-pa-md"},ce={class:"text-h5 text-center"},me=S({__name:"WorkoutExerciseModal",props:{exercise:{}},emits:W.emits,setup(T){const p=T,d=L(),{dialogRef:y,onDialogOK:b,onDialogHide:w}=W(),t=q({type:p.exercise?.type??1,reps:p.exercise?.reps??0,sets:p.exercise?.sets??0,rest:p.exercise?.rest??null,time:p.exercise?.time??0});function m(u=null){return Object.values(Object.values(d.exercisesTypes)).filter(a=>!u||a.description.toLowerCase().includes(u.toLowerCase()))}const i=q(m());function s(){const u={type:t.value.type};d.exercisesTypes[t.value.type].isBasic?(u.reps=t.value.reps,u.sets=t.value.sets,u.rest=t.value.rest):u.time=t.value.time,b(u)}return(u,a)=>(n(),c(z,{onHide:g(w),ref_key:"dialogRef",ref:y,"no-backdrop-dismiss":"","no-shake":""},{default:o(()=>[h("div",de,[e(N,{class:"row items-center q-pb-md"},{default:o(()=>[h("div",ce,_(u.exercise?"Редактирование упражнения":"Добавление упражнения"),1),e(j),$(e(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[K]])]),_:1}),e(M,{spaced:"lg"}),e(ne,{modelValue:t.value.type,"onUpdate:modelValue":a[0]||(a[0]=l=>t.value.type=l),options:i.value,onFilter:a[1]||(a[1]=(l,x)=>{x(()=>{i.value=m(l)})}),label:"Тип упражнения","option-label":"description","option-value":"type","input-debounce":"0",class:"q-mb-md","hide-selected":"","fill-input":"","use-input":"","map-options":"","emit-value":"",outlined:""},null,8,["modelValue","options"]),!g(d).exercisesTypes[t.value.type].isBasic&&typeof t.value.time=="number"?(n(),c(A,{key:0,modelValue:t.value.time,"onUpdate:modelValue":a[2]||(a[2]=l=>t.value.time=l),label:"Время выполнения",class:"q-mb-md"},null,8,["modelValue"])):(n(),Q(E,{key:1},[e(B,{modelValue:t.value.reps,"onUpdate:modelValue":a[3]||(a[3]=l=>t.value.reps=l),modelModifiers:{number:!0},type:"number",label:"Количество повторений",class:"q-mb-md",outlined:""},null,8,["modelValue"]),e(B,{modelValue:t.value.sets,"onUpdate:modelValue":a[4]||(a[4]=l=>t.value.sets=l),modelModifiers:{number:!0},type:"number",label:"Количество подходов",class:"q-mb-md",outlined:""},null,8,["modelValue"]),e(Z,{"model-value":t.value.rest!==null,"onUpdate:modelValue":a[5]||(a[5]=l=>t.value.rest=l?0:null),label:"Нужен перерыв между подходами",class:"q-mb-md"},null,8,["model-value"]),typeof t.value.rest=="number"?(n(),c(A,{key:0,modelValue:t.value.rest,"onUpdate:modelValue":a[6]||(a[6]=l=>t.value.rest=l),disable:t.value.rest===null,label:"Время перерыва между подходами",class:"q-mb-md"},null,8,["modelValue","disable"])):C("",!0)],64)),e(U,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{onClick:s,"text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[r(" Применить ")]),_:1})]),_:1})]),_:1})])]),_:1},8,["onHide"]))}}),X=O(me,[["__file","WorkoutExerciseModal.vue"]]),pe={class:"card-container bg-dark q-pa-md"},fe={class:"text-h5 text-center"},_e=S({__name:"WorkoutModal",props:{workout:{},workoutIndex:{}},emits:W.emits,setup(T){const p=J(),d=T,y=L(),{dialogRef:b,onDialogOK:w,onDialogHide:t}=W(),m=q(!1),i=q({name:d.workout?.name||"",estimatedTime:d.workout?.estimatedTime||0,exercises:d.workout?.exercises||[]});function s(l,x){p.dialog({component:X,componentProps:{exercise:l}}).onOk(f=>{i.value.exercises[x]=f})}function u(){p.dialog({component:X}).onOk(l=>{i.value.exercises.push(l)})}async function a(){m.value=!0;const l=d.workoutIndex?await y.updateWorkout(d.workoutIndex,i.value):await y.createWorkout(i.value);m.value=!1,l&&w()}return(l,x)=>(n(),c(z,{onHide:g(t),ref_key:"dialogRef",ref:b,"no-backdrop-dismiss":"","no-shake":""},{default:o(()=>[h("div",pe,[e(N,{class:"row items-center q-pb-md"},{default:o(()=>[h("div",fe,_(l.workout?"Редактирование тренировки":"Создание тренировки"),1),e(j),$(e(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[K]])]),_:1}),e(M,{spaced:"lg"}),e(ee,{onSubmit:a},{default:o(()=>[e(B,{modelValue:i.value.name,"onUpdate:modelValue":x[0]||(x[0]=f=>i.value.name=f),label:"Название тренировки",class:"q-mb-md",autofocus:"",outlined:""},null,8,["modelValue"]),e(A,{modelValue:i.value.estimatedTime,"onUpdate:modelValue":x[1]||(x[1]=f=>i.value.estimatedTime=f),label:"Время выполнения тренировки"},null,8,["modelValue"]),e(G,{class:"q-my-md scroll",style:{"max-height":"calc(100vh - 24rem)"}},{default:o(()=>[(n(!0),Q(E,null,R(i.value.exercises,(f,H)=>$((n(),c(I,{key:H,onClick:oe=>s(f,H),clickable:""},{default:o(()=>[e(V,null,{default:o(()=>[e(k,null,{default:o(()=>[r(_(g(y).exercisesTypes[f.type].description),1)]),_:2},1024),f.time?(n(),c(k,{key:0,caption:""},{default:o(()=>[r(" Время выполнения - "+_(g(P)(f.time)),1)]),_:2},1024)):f.rest?(n(),c(k,{key:1,caption:""},{default:o(()=>[r(" Перерыв между подходами - "+_(g(P)(f.rest)),1)]),_:2},1024)):C("",!0)]),_:2},1024),g(y).exercisesTypes[f.type].isBasic?(n(),c(V,{key:0,side:""},{default:o(()=>[e(k,{caption:""},{default:o(()=>[r(" Повторений: "+_(f.reps),1)]),_:2},1024),e(k,{caption:""},{default:o(()=>[r(" Подходов: "+_(f.sets),1)]),_:2},1024)]),_:2},1024)):C("",!0),e(V,{side:""},{default:o(()=>[e(v,{onClick:F(oe=>i.value.exercises.splice(H,1),["stop"]),"text-color":"negative",color:"secondary",size:"sm",icon:"close",round:"",flat:""},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])),[[te]])),128))]),_:1}),e(U,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{onClick:u,"text-color":"info",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[r(" Добавить упражнение ")]),_:1}),e(v,{loading:m.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[r(" Применить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["onHide"]))}}),Y=O(_e,[["__file","WorkoutModal.vue"]]),ke={class:"card-container card-container--sm bg-dark q-pa-md"},ge=h("div",{class:"text-h5 text-center"},"Добавление упражнения",-1),ve=S({__name:"WorkoutCreateExerciseModal",emits:W.emits,setup(T){const{dialogRef:p,onDialogOK:d,onDialogHide:y}=W(),b=L(),w=q(!1),t=q({type:Object.values(b.exercisesTypes).length+1,description:"",isBasic:!0});async function m(){await ae.createExercise(t.value)&&(await b.getExercisesTypes(),d())}return(i,s)=>(n(),c(z,{onHide:g(y),ref_key:"dialogRef",ref:p,"no-backdrop-dismiss":"","no-shake":""},{default:o(()=>[h("div",ke,[e(N,{class:"row items-center q-pb-md"},{default:o(()=>[ge,e(j),$(e(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[K]])]),_:1}),e(M,{spaced:"lg"}),e(ee,{onSubmit:m},{default:o(()=>[e(B,{modelValue:t.value.description,"onUpdate:modelValue":s[0]||(s[0]=u=>t.value.description=u),label:"Название упражнения",class:"q-mb-md",autofocus:"",outlined:""},null,8,["modelValue"]),e(Z,{modelValue:t.value.isBasic,"onUpdate:modelValue":s[1]||(s[1]=u=>t.value.isBasic=u),label:"С подходами и повторениями",class:"q-mb-md"},null,8,["modelValue"]),e(U,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{loading:w.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[r(" Добавить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["onHide"]))}}),ye=O(ve,[["__file","WorkoutCreateExerciseModal.vue"]]),be={key:0,class:"card-container column"},xe={class:"row"},Ve=S({__name:"WorkoutPage",setup(T){const p=J(),d=L();function y(m){const i={name:m.name,estimatedTime:m.estimatedTime,exercises:[]};m.exercises.forEach(s=>{s.type.isBasic?i.exercises.push({type:s.type.type,reps:s.reps,sets:s.sets,rest:s.rest}):i.exercises.push({type:s.type.type,time:s.time})}),p.dialog({component:Y,componentProps:{workout:i,workoutIndex:m.id}})}function b(){p.dialog({component:Y})}function w(){p.dialog({component:ye,componentProps:{isPool:!0}})}function t(m){p.dialog({title:"Удаление тренировки",message:"Вы уверены, что хотите удалить тренировку?",persistent:!0,ok:{color:"negative",label:"Удалить"},cancel:{color:"secondary",label:"Отменить"}}).onOk(()=>{d.deleteWorkout(m)})}return se(d.loadPage),le(()=>{d.isPageLoaded=!1}),(m,i)=>(n(),c(re,{class:"column items-center",padding:""},{default:o(()=>[g(d).isPageLoaded?(n(),Q("div",be,[e(G,{class:"bg-secondary border-radius-8 overflow-hidden q-mb-lg"},{default:o(()=>[(n(!0),Q(E,null,R(g(d).workoutsPool,(s,u)=>(n(),Q(E,{key:s.id},[u?(n(),c(M,{key:0})):C("",!0),e(ie,{label:s.name,"content-inset-level":.3},{header:o(()=>[e(V,null,{default:o(()=>[e(k,null,{default:o(()=>[r(_(s.name),1)]),_:2},1024),e(k,{caption:""},{default:o(()=>[r(" Время проведения: "+_(g(P)(s.estimatedTime)),1)]),_:2},1024)]),_:2},1024),e(V,{side:""},{default:o(()=>[h("div",xe,[e(v,{onClick:F(a=>y(s),["stop"]),color:"positive",icon:"edit",size:"sm",flat:"",round:""},null,8,["onClick"]),e(v,{onClick:F(a=>t(s.id),["stop"]),color:"negative",icon:"close",size:"sm",round:"",flat:""},null,8,["onClick"])])]),_:2},1024)]),default:o(()=>[(n(!0),Q(E,null,R(s.exercises,(a,l)=>(n(),c(I,{key:l},{default:o(()=>[e(V,null,{default:o(()=>[e(k,null,{default:o(()=>[r(_(a.type.description),1)]),_:2},1024),a.time?(n(),c(k,{key:0,caption:""},{default:o(()=>[r(" Время выполнения - "+_(g(P)(a.time)),1)]),_:2},1024)):a.rest?(n(),c(k,{key:1,caption:""},{default:o(()=>[r(" Перерыв между подходами - "+_(g(P)(a.rest)),1)]),_:2},1024)):C("",!0)]),_:2},1024),a.type.isBasic?(n(),c(V,{key:0,side:""},{default:o(()=>[e(k,{caption:""},{default:o(()=>[r(" Повторений: "+_(a.reps),1)]),_:2},1024),e(k,{caption:""},{default:o(()=>[r(" Подходов: "+_(a.sets),1)]),_:2},1024)]),_:2},1024)):C("",!0)]),_:2},1024))),128)),s.exercises.length===0?(n(),c(I,{key:0},{default:o(()=>[e(V,null,{default:o(()=>[e(k,null,{default:o(()=>[r(" Нет упражнений ")]),_:1})]),_:1})]),_:1})):C("",!0)]),_:2},1032,["label"])],64))),128))]),_:1}),e(U,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{onClick:b,color:"secondary","text-color":"info",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[r(" Добавить тренировку ")]),_:1}),e(v,{onClick:w,color:"secondary","text-color":"warning",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[r(" Добавить упражнение ")]),_:1})]),_:1})]),_:1})])):(n(),c(ue,{key:1}))]),_:1}))}}),Be=O(Ve,[["__file","WorkoutPage.vue"]]);export{Be as default};
