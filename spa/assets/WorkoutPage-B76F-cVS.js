import{d as S,r as q,R as n,S as m,U as o,Y as C,f as e,a3 as A,ay as k,ag as $,Q as v,X as U,W as g,au as Q,F as E,a4 as B,aU as Y,aw as h,a2 as M,as as D,V as d,at as N,a0 as O,av as R,az as F,aA as te,a5 as ae,o as se,E as le}from"./index-CrMxzk4B.js";import{Q as G,a as J,b as w,c as _}from"./QList-DMvAb0PL.js";import{Q as ne,c as ie}from"./QExpansionItem-D5ro2CRs.js";import{Q as re}from"./QPage-VYgDHi1e.js";import{u as W,Q as z,C as j,a as Z,i as P,I as de}from"./use-quasar-4RUW9YXV.js";import{Q as ee}from"./QForm-HPt2PszO.js";import{u as L,T as I}from"./useWorkoutStore-L-g91ctD.js";import"./QMenu-DDL4rfaS.js";import"./format-BoKE-3dj.js";import"./rtl-DFPa-2ov.js";const ue={class:"card-container card-container--sm bg-dark q-pa-md"},ce={class:"text-h5 text-center"},me=S({__name:"WorkoutExerciseModal",props:{exercise:{}},emits:W.emits,setup(T){const p=T,u=L(),{dialogRef:y,onDialogOK:b,onDialogHide:V}=W(),t=q({type:p.exercise?.type??1,reps:p.exercise?.reps??0,sets:p.exercise?.sets??0,rest:p.exercise?.rest??null,time:p.exercise?.time??0});function c(r=null){return Object.values(Object.values(u.exercisesTypes)).filter(a=>!r||a.description.toLowerCase().includes(r.toLowerCase()))}const i=q(c());function s(){const r={type:t.value.type};u.exercisesTypes[t.value.type].isBasic?(r.reps=t.value.reps,r.sets=t.value.sets,r.rest=t.value.rest):r.time=t.value.time,b(r)}return(r,a)=>(n(),m(N,{onHide:g(V),ref_key:"dialogRef",ref:y,"no-backdrop-dismiss":"","no-shake":""},{default:o(()=>[C("div",ue,[e(A,{class:"row items-center q-pb-md"},{default:o(()=>[C("div",ce,k(r.exercise?"Редактирование упражнения":"Добавление упражнения"),1),e(z),$(e(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[j]])]),_:1}),e(U,{spaced:"lg"}),e(ne,{modelValue:t.value.type,"onUpdate:modelValue":a[0]||(a[0]=l=>t.value.type=l),options:i.value,onFilter:a[1]||(a[1]=(l,x)=>{x(()=>{i.value=c(l)})}),label:"Тип упражнения","option-label":"description","option-value":"type","input-debounce":"0",class:"q-mb-md","hide-selected":"","fill-input":"","use-input":"","map-options":"","emit-value":"",outlined:""},null,8,["modelValue","options"]),!g(u).exercisesTypes[t.value.type].isBasic&&typeof t.value.time=="number"?(n(),m(I,{key:0,modelValue:t.value.time,"onUpdate:modelValue":a[2]||(a[2]=l=>t.value.time=l),label:"Время выполнения",class:"q-mb-md"},null,8,["modelValue"])):(n(),Q(E,{key:1},[e(B,{modelValue:t.value.reps,"onUpdate:modelValue":a[3]||(a[3]=l=>t.value.reps=l),modelModifiers:{number:!0},type:"number",label:"Количество повторений",class:"q-mb-md",outlined:""},null,8,["modelValue"]),e(B,{modelValue:t.value.sets,"onUpdate:modelValue":a[4]||(a[4]=l=>t.value.sets=l),modelModifiers:{number:!0},type:"number",label:"Количество подходов",class:"q-mb-md",outlined:""},null,8,["modelValue"]),e(Y,{"model-value":t.value.rest!==null,"onUpdate:modelValue":a[5]||(a[5]=l=>t.value.rest=l?0:null),label:"Нужен перерыв между подходами",class:"q-mb-md"},null,8,["model-value"]),typeof t.value.rest=="number"?(n(),m(I,{key:0,modelValue:t.value.rest,"onUpdate:modelValue":a[6]||(a[6]=l=>t.value.rest=l),disable:t.value.rest===null,label:"Время перерыва между подходами",class:"q-mb-md"},null,8,["modelValue","disable"])):h("",!0)],64)),e(M,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{onClick:s,"text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[d(" Применить ")]),_:1})]),_:1})]),_:1})])]),_:1},8,["onHide"]))}}),K=O(me,[["__file","WorkoutExerciseModal.vue"]]),pe={class:"card-container bg-dark q-pa-md"},fe={class:"text-h5 text-center"},ke=S({__name:"WorkoutModal",props:{workout:{},workoutIndex:{}},emits:W.emits,setup(T){const p=Z(),u=T,y=L(),{dialogRef:b,onDialogOK:V,onDialogHide:t}=W(),c=q(!1),i=q({name:u.workout?.name||"",estimatedTime:u.workout?.estimatedTime||0,exercises:u.workout?.exercises||[]});function s(l,x){p.dialog({component:K,componentProps:{exercise:l}}).onOk(f=>{i.value.exercises[x]=f})}function r(){p.dialog({component:K}).onOk(l=>{i.value.exercises.push(l)})}async function a(){c.value=!0;const l=u.workoutIndex?await y.updateWorkout(u.workoutIndex,i.value):await y.createWorkout(i.value);c.value=!1,l&&V()}return(l,x)=>(n(),m(N,{onHide:g(t),ref_key:"dialogRef",ref:b,"no-backdrop-dismiss":"","no-shake":""},{default:o(()=>[C("div",pe,[e(A,{class:"row items-center q-pb-md"},{default:o(()=>[C("div",fe,k(l.workout?"Редактирование тренировки":"Создание тренировки"),1),e(z),$(e(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[j]])]),_:1}),e(U,{spaced:"lg"}),e(ee,{onSubmit:a},{default:o(()=>[e(B,{modelValue:i.value.name,"onUpdate:modelValue":x[0]||(x[0]=f=>i.value.name=f),label:"Название тренировки",class:"q-mb-md",autofocus:"",outlined:""},null,8,["modelValue"]),e(I,{modelValue:i.value.estimatedTime,"onUpdate:modelValue":x[1]||(x[1]=f=>i.value.estimatedTime=f),label:"Время выполнения тренировки"},null,8,["modelValue"]),e(G,{class:"q-my-md scroll",style:{"max-height":"calc(100vh - 24rem)"}},{default:o(()=>[(n(!0),Q(E,null,R(i.value.exercises,(f,H)=>$((n(),m(J,{key:H,onClick:oe=>s(f,H),clickable:""},{default:o(()=>[e(w,null,{default:o(()=>[e(_,null,{default:o(()=>[d(k(g(y).exercisesTypes[f.type].description),1)]),_:2},1024),f.time?(n(),m(_,{key:0,caption:""},{default:o(()=>[d(" Время выполнения - "+k(g(P)(f.time)),1)]),_:2},1024)):f.rest?(n(),m(_,{key:1,caption:""},{default:o(()=>[d(" Перерыв между подходами - "+k(g(P)(f.rest)),1)]),_:2},1024)):h("",!0)]),_:2},1024),g(y).exercisesTypes[f.type].isBasic?(n(),m(w,{key:0,side:""},{default:o(()=>[e(_,{caption:""},{default:o(()=>[d(" Повторений: "+k(f.reps),1)]),_:2},1024),e(_,{caption:""},{default:o(()=>[d(" Подходов: "+k(f.sets),1)]),_:2},1024)]),_:2},1024)):h("",!0),e(w,{side:""},{default:o(()=>[e(v,{onClick:F(oe=>i.value.exercises.splice(H,1),["stop"]),"text-color":"negative",color:"secondary",size:"sm",icon:"close",round:"",flat:""},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])),[[te]])),128))]),_:1}),e(M,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{onClick:r,"text-color":"info",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[d(" Добавить упражнение ")]),_:1}),e(v,{loading:c.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[d(" Применить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["onHide"]))}}),X=O(ke,[["__file","WorkoutModal.vue"]]),ge={class:"card-container card-container--sm bg-dark q-pa-md"},_e=C("div",{class:"text-h5 text-center"},"Добавление упражнения",-1),ve=S({__name:"WorkoutCreateExerciseModal",emits:W.emits,setup(T){const{dialogRef:p,onDialogOK:u,onDialogHide:y}=W(),b=L(),V=q(!1),t=q({type:Object.values(b.exercisesTypes).length+1,description:"",isBasic:!0});async function c(){await ae.createExercise(t.value)&&(await b.getExercisesTypes(),u())}return(i,s)=>(n(),m(N,{onHide:g(y),ref_key:"dialogRef",ref:p,"no-backdrop-dismiss":"","no-shake":""},{default:o(()=>[C("div",ge,[e(A,{class:"row items-center q-pb-md"},{default:o(()=>[_e,e(z),$(e(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[j]])]),_:1}),e(U,{spaced:"lg"}),e(ee,{onSubmit:c},{default:o(()=>[e(B,{modelValue:t.value.description,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value.description=r),label:"Название упражнения",class:"q-mb-md",autofocus:"",outlined:""},null,8,["modelValue"]),e(Y,{modelValue:t.value.isBasic,"onUpdate:modelValue":s[1]||(s[1]=r=>t.value.isBasic=r),label:"Базовое упражнение (без подходов и повторений)",class:"q-mb-md"},null,8,["modelValue"]),e(M,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{loading:V.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[d(" Добавить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["onHide"]))}}),ye=O(ve,[["__file","WorkoutCreateExerciseModal.vue"]]),be={key:0,class:"card-container column"},xe={class:"row"},Ve=S({__name:"WorkoutPage",setup(T){const p=Z(),u=L();function y(c){const i={name:c.name,estimatedTime:c.estimatedTime,exercises:[]};c.exercises.forEach(s=>{s.type.isBasic?i.exercises.push({type:s.type.type,reps:s.reps,sets:s.sets,rest:s.rest}):i.exercises.push({type:s.type.type,time:s.time})}),p.dialog({component:X,componentProps:{workout:i,workoutIndex:c.id}})}function b(){p.dialog({component:X})}function V(){p.dialog({component:ye,componentProps:{isPool:!0}})}function t(c){p.dialog({title:"Удаление тренировки",message:"Вы уверены, что хотите удалить тренировку?",persistent:!0,ok:{color:"negative",label:"Удалить"},cancel:{color:"secondary",label:"Отменить"}}).onOk(()=>{u.deleteWorkout(c)})}return se(u.loadPage),le(()=>{u.isPageLoaded=!1}),(c,i)=>(n(),m(re,{class:"column items-center",padding:""},{default:o(()=>[g(u).isPageLoaded?(n(),Q("div",be,[e(G,{class:"bg-secondary border-radius-8 overflow-hidden q-mb-lg"},{default:o(()=>[(n(!0),Q(E,null,R(g(u).workoutsPool,(s,r)=>(n(),Q(E,{key:s.id},[r?(n(),m(U,{key:0})):h("",!0),e(ie,{label:s.name,"content-inset-level":.3},{header:o(()=>[e(w,null,{default:o(()=>[e(_,null,{default:o(()=>[d(k(s.name),1)]),_:2},1024),e(_,{caption:""},{default:o(()=>[d(" Время проведения: "+k(g(P)(s.estimatedTime)),1)]),_:2},1024)]),_:2},1024),e(w,{side:""},{default:o(()=>[C("div",xe,[e(v,{onClick:F(a=>y(s),["stop"]),color:"positive",icon:"edit",size:"sm",flat:"",round:""},null,8,["onClick"]),e(v,{onClick:F(a=>t(s.id),["stop"]),color:"negative",icon:"close",size:"sm",round:"",flat:""},null,8,["onClick"])])]),_:2},1024)]),default:o(()=>[(n(!0),Q(E,null,R(s.exercises,(a,l)=>(n(),m(J,{key:l},{default:o(()=>[e(w,null,{default:o(()=>[e(_,null,{default:o(()=>[d(k(a.type.description),1)]),_:2},1024),a.time?(n(),m(_,{key:0,caption:""},{default:o(()=>[d(" Время выполнения - "+k(g(P)(a.time)),1)]),_:2},1024)):a.rest?(n(),m(_,{key:1,caption:""},{default:o(()=>[d(" Перерыв между подходами - "+k(g(P)(a.rest)),1)]),_:2},1024)):h("",!0)]),_:2},1024),a.type.isBasic?(n(),m(w,{key:0,side:""},{default:o(()=>[e(_,{caption:""},{default:o(()=>[d(" Повторений: "+k(a.reps),1)]),_:2},1024),e(_,{caption:""},{default:o(()=>[d(" Подходов: "+k(a.sets),1)]),_:2},1024)]),_:2},1024)):h("",!0)]),_:2},1024))),128))]),_:2},1032,["label"])],64))),128))]),_:1}),e(M,{class:"bg-transparent",flat:""},{default:o(()=>[e(D,{class:"row q-pa-none"},{default:o(()=>[e(v,{onClick:b,color:"secondary","text-color":"info",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[d(" Добавить тренировку ")]),_:1}),e(v,{onClick:V,color:"secondary","text-color":"warning",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:o(()=>[d(" Добавить упражнение ")]),_:1})]),_:1})]),_:1})])):(n(),m(de,{key:1}))]),_:1}))}}),Be=O(Ve,[["__file","WorkoutPage.vue"]]);export{Be as default};
