import{u as re,a as ue,b as de,Q as ie}from"./QTabs-DnRI7zvN.js";import{z as se,h as me,d as C,r as V,l as m,m as v,n as a,q as _,f as e,v as I,Q as P,a8 as E,x as b,y as g,a9 as A,A as U,_ as h,c as Q,aa as H,P as S,o as ce,E as pe,ab as J,ac as $,F as O,ad as X,ae as ee,af as fe,ag as F,ah as ve,ai as ge}from"./index-DzM_srFz.js";import{Q as be}from"./QToolbar-BCXDvqGD.js";import{Q as N,a as x,b as G}from"./QItemLabel-BBVA7O39.js";import{Q as ae}from"./QList-Daj5B4BR.js";import{Q as _e}from"./QMenu-B6mTulVv.js";import{Q as ke}from"./QPage-Ciq5b9Oz.js";import{u as ne,Q as oe,a as ye,T as le,C as j}from"./useWorkoutStore-jgE2j8Ay.js";import{I as Ve}from"./InnerLoading-DS6JcJwB.js";import{Q as L}from"./QForm-CtDzycCP.js";import{u as w,a as Te}from"./use-quasar-OsAyRxUY.js";import{Q as W}from"./QSelect-5zrMXQeR.js";import{u as Z,Q as qe}from"./QDate-BaGNRjBk.js";import"./QResizeObserver-CZXnG2jb.js";import"./format-DPS1XQ7V.js";import"./TouchPan-Ct6QzyD3.js";import"./date-B3h-bvU3.js";const we=se({name:"QTab",props:re,emits:ue,setup(q,{slots:r,emit:k}){const{renderTab:n}=de(q,r,k);return()=>n("div")}}),Qe=me("div",{class:"q-space"}),$e=se({name:"QSpace",setup(){return()=>Qe}}),xe={class:"card-container card-container--sm bg-dark q-pa-md"},Ie=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Добавление спортсмена",-1),Se=C({__name:"TeamSportsmanModal",emits:w.emits,setup(q){const{dialogRef:r,onDialogOK:k}=w(),n=V(""),i=V(!1),o=V(null);async function p(){i.value=!0,await U.addSportsman({email:n.value}),i.value=!1,k()}return(T,f)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:r},{default:a(()=>[_("div",xe,[e(L,{onSubmit:p},{default:a(()=>[Ie,e(I,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=d=>n.value=d),rules:[d=>!!d||"Поле обязательно для заполнения",d=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(d)||"Некорректный email"],onKeydown:f[1]||(f[1]=d=>o.value.resetValidation()),onBlur:f[2]||(f[2]=d=>o.value.validate()),autocapitalize:"off",label:"Почта спортсмена",type:"email",inputmode:"email",ref_key:"emailInput",ref:o,class:"q-mb-sm","lazy-rules":"",outlined:"",autofocus:""},null,8,["modelValue","rules"]),e(P,{class:"bg-transparent",flat:""},{default:a(()=>[e(E,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:i.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Применить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),Ce=h(Se,[["__file","TeamSportsmanModal.vue"]]),Pe={class:"card-container card-container--sm bg-dark q-pa-md"},Ee=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Добавление группы",-1),he=C({__name:"TeamGroupModal",emits:w.emits,setup(q){const{dialogRef:r,onDialogOK:k}=w(),n=Z(),i=V({name:"",sportsmansEmails:[]}),o=V(!1),p=V(null),T=Q(()=>n.team?Object.values(n.team?.sportsmans).map(d=>({label:`${d.middleName} ${d.firstName} ${d.lastName}`,value:d.email})):[]);async function f(){o.value=!0;const d=await n.createGroup(i.value);o.value=!1,d&&k(d)}return(d,l)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:r},{default:a(()=>[_("div",Pe,[e(L,{onSubmit:f},{default:a(()=>[Ee,e(I,{modelValue:i.value.name,"onUpdate:modelValue":l[0]||(l[0]=t=>i.value.name=t),rules:[t=>!!t||"Поле обязательно для заполнения"],onKeydown:l[1]||(l[1]=t=>p.value.resetValidation()),onBlur:l[2]||(l[2]=t=>p.value.validate()),label:"Название группы",ref_key:"nameInput",ref:p,class:"q-mb-md","hide-bottom-space":"","lazy-rules":"",outlined:""},null,8,["modelValue","rules"]),e(W,{modelValue:i.value.sportsmansEmails,"onUpdate:modelValue":l[3]||(l[3]=t=>i.value.sportsmansEmails=t),options:T.value,label:"Список спортсменов",class:"q-mb-md","use-chips":"",multiple:"","map-options":"","emit-value":"",outlined:""},{"no-option":a(()=>[e(N,null,{default:a(()=>[e(x,{class:"text-italic text-grey"},{default:a(()=>[g(" Список для добавления пуст ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"]),e(P,{class:"bg-transparent",flat:""},{default:a(()=>[e(E,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:o.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Добавить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),De=h(he,[["__file","TeamGroupModal.vue"]]),Me={class:"card-container card-container--sm bg-dark q-pa-md"},Oe=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Добавление спортсменов",-1),Ge=C({__name:"TeamAddToGroupModal",props:{sportsmansEmails:{},groupId:{}},emits:w.emits,setup(q){const r=q,{dialogRef:k,onDialogOK:n}=w(),i=Z(),o=V({sportsmansEmails:r.sportsmansEmails||[],groupId:r.groupId||""}),p=V(!1),T=Q(()=>i.groups?Object.values(i.groups).map(l=>({label:l.name,value:l.id})):[]),f=Q(()=>i.team?Object.values(i.team?.sportsmans).filter(l=>!i.groups[o.value.groupId]?.sportsmans[l.id]).map(l=>({label:`${l.middleName} ${l.firstName} ${l.lastName}`,value:l.email})):[]);async function d(){p.value=!0,await i.addSportsmanToGroup(o.value),p.value=!1,n()}return(l,t)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:k},{default:a(()=>[_("div",Me,[e(L,{onSubmit:d},{default:a(()=>[Oe,e(W,{modelValue:o.value.groupId,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.groupId=s),options:T.value,disable:!!l.groupId,label:"Группа",class:"q-mb-md",outlined:"","map-options":"","emit-value":""},null,8,["modelValue","options","disable"]),e(W,{modelValue:o.value.sportsmansEmails,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.sportsmansEmails=s),options:f.value,disable:!!l.sportsmansEmails,"use-chips":!l.sportsmansEmails,label:l.sportsmansEmails?"Спортсмен":"Список спортсменов",class:"q-mb-md",outlined:"",multiple:"","map-options":"","emit-value":""},null,8,["modelValue","options","disable","use-chips","label"]),e(P,{class:"bg-transparent",flat:""},{default:a(()=>[e(E,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:p.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Добавить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),te=h(Ge,[["__file","TeamAddToGroupModal.vue"]]),Ue={class:"card-container card-container--sm bg-dark q-pa-md"},Ne=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Создание тренировки",-1),je={class:"row items-center justify-end"},We={class:"row items-center justify-end"},Ae=C({__name:"TeamWorkoutModal",props:{sportsmanEmail:{},groupId:{}},emits:w.emits,setup(q){const r=q,{dialogRef:k,onDialogOK:n}=w(),i=ne(),o=V({workoutPoolId:"",date:"",restTime:0,stressQuestionnaireTime:0,comment:null,goal:null}),p=V(!1),T=Q(()=>r.sportsmanEmail?"Индивидуальная":r.groupId?"Групповая":"Командная"),f=Q(()=>i.workoutsPool?Object.values(i.workoutsPool).map(l=>({label:l.name,value:l.id})):[]);async function d(){p.value=!0;const l=new Date,[t,s]=o.value.date.split(" "),[D,z,R]=t.split("."),[Y,B]=s.split(":");l.setFullYear(+R,+z-1,+D),l.setHours(+Y,+B),l.setSeconds(0);const u={...o.value,date:l.toISOString().slice(0,-1)};r.sportsmanEmail?await U.createSportsmanWorkout({...u,sportsmanEmail:r.sportsmanEmail}):r.groupId?await U.createGroupWorkout({...u,groupId:r.groupId}):await U.createTeamWorkout(u),n()}return(l,t)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:k},{default:a(()=>[_("div",Ue,[Ne,e(L,{onSubmit:d},{default:a(()=>[e(I,{"model-value":T.value,label:"Тип тренировки",class:"q-mb-md",outlined:"",readonly:""},null,8,["model-value"]),e(I,{modelValue:o.value.goal,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.goal=s),label:"Цель тренировки",class:"q-mb-md",outlined:"","hide-bottom-space":""},null,8,["modelValue"]),e(I,{modelValue:o.value.comment,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.comment=s),label:"Комментарий к тренировке",class:"q-mb-md",outlined:"","hide-bottom-space":""},null,8,["modelValue"]),e(W,{modelValue:o.value.workoutPoolId,"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.workoutPoolId=s),options:f.value,rules:[s=>!!s||"Обязательное поле"],required:"",label:"Тренировка",class:"q-mb-md","hide-bottom-space":"",outlined:"","map-options":"","emit-value":""},null,8,["modelValue","options","rules"]),e(I,{modelValue:o.value.date,"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.date=s),rules:[s=>/^[0-9]{2}\.[0-9]{2}\.[0-9]{4} [0-9]{2}:[0-9]{2}$/.test(s)||"Некорректная дата",s=>!!s||"Обязательное поле"],label:"Дата и время начала тренировки",class:"q-mb-md","hide-bottom-space":"",outlined:""},{prepend:a(()=>[e(H,{name:"event",class:"cursor-pointer"},{default:a(()=>[e(oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(qe,{modelValue:o.value.date,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.date=s),options:s=>new Date<new Date(s),mask:"DD.MM.YYYY HH:mm",color:"secondary"},{default:a(()=>[_("div",je,[S(e(b,{label:"Закрыть","no-caps":"",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","options"])]),_:1})]),_:1})]),append:a(()=>[e(H,{name:"access_time",class:"cursor-pointer"},{default:a(()=>[e(oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(ye,{modelValue:o.value.date,"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.date=s),mask:"DD.MM.YYYY HH:mm",color:"secondary",format24h:""},{default:a(()=>[_("div",We,[S(e(b,{label:"Закрыть","no-caps":"",flat:""},null,512),[[j]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),e(le,{modelValue:o.value.restTime,"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.restTime=s),label:"Время отдыха после тренировки",class:"q-mb-md"},null,8,["modelValue"]),e(le,{modelValue:o.value.stressQuestionnaireTime,"onUpdate:modelValue":t[7]||(t[7]=s=>o.value.stressQuestionnaireTime=s),label:"Время для нагрузочного опросника",class:"q-mb-md"},null,8,["modelValue"]),e(P,{class:"bg-transparent",flat:""},{default:a(()=>[e(E,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:p.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Создать ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),K=h(Ae,[["__file","TeamWorkoutModal.vue"]]),Le={class:"row items-center justify-around full-width"},ze={class:"card-container column"},Re={key:0,class:"text-center q-mt-xs q-mb-none"},Ye=["src"],Be=C({__name:"TeamPage",setup(q){const r=Te(),k=ne(),n=Z(),i=Q(()=>[{label:"Все спортсмены",value:"all"},...Object.values(n.groups).map(u=>({label:u.name,value:u.id}))]),o=V("all"),p=Q(()=>n.team?o.value==="all"?n.team.sportsmans:n.groups[o.value]?n.groups[o.value].sportsmans:{}:{});function T(u){return`${u.middleName} ${u.firstName} ${u.lastName}`}function f(u){return Object.values(n.groups).find(y=>y.sportsmans[u.id])?.name||"Без группы"}function d(){r.dialog({component:Ce})}function l(){r.dialog({component:De}).onOk(u=>{o.value=u})}function t(u){r.dialog({component:te,componentProps:{sportsmansEmails:[u]}})}function s(){r.dialog({component:te,componentProps:{groupId:o.value}})}function D(u){r.dialog({title:"Удалить группу?",message:"Группа будет удалена без возможности восстановления",persistent:!0,ok:{color:"negative",label:"Удалить",noCaps:!0},cancel:{color:"secondary",label:"Отменить",noCaps:!0}}).onOk(()=>{n.deleteGroup(u),o.value="all"})}function z(u,y){r.dialog({title:"Удалить из группы?",message:`Вы уверены, что хотите удалить ${T(y)} из группы?`,persistent:!0,ok:{color:"negative",label:"Удалить",noCaps:!0},cancel:{color:"secondary",label:"Отменить",noCaps:!0}}).onOk(()=>{n.deleteFromGroup(u,y.email)})}function R(){r.dialog({component:K})}function Y(u){r.dialog({component:K,componentProps:{sportsmanEmail:u}})}function B(u){r.dialog({component:K,componentProps:{groupId:u}})}return ce(async()=>{await k.loadWorkoutData(),await n.loadPage()}),pe(()=>{n.isPageLoaded=!1}),(u,y)=>(m(),v(ke,{class:"column items-center",padding:""},{default:a(()=>[J(n).isPageLoaded?(m(),$(O,{key:0},[e(be,{class:"bg-secondary text-white q-mb-md"},{default:a(()=>[e(ie,{modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=c=>o.value=c),class:"q-ml-xs","inline-label":""},{default:a(()=>[(m(!0),$(O,null,X(i.value,(c,M)=>(m(),v(we,{key:M,label:c.label,name:c.value,"no-caps":""},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),e($e),e(b,{onClick:l,color:"info",label:"Добавить группу","icon-right":"group_add",class:"q-mr-sm","no-caps":"",flat:""}),e(b,{onClick:d,label:"Добавить спортсмена",color:"positive","icon-right":"person_add","no-caps":""})]),_:1}),_("div",Le,[_("div",ze,[Object.values(p.value).length===0?(m(),$("h5",Re," Список спортсменов пуст ")):ee("",!0),e(ae,{class:"bg-secondary border-radius-8 overflow-hidden q-mb-md",separator:""},{default:a(()=>[(m(!0),$(O,null,X(p.value,c=>S((m(),v(N,{key:c.id,clickable:""},{default:a(()=>[e(x,{avatar:""},{default:a(()=>[e(fe,null,{default:a(()=>[c.avatarUri?(m(),$("img",{key:0,src:c.avatarUri},null,8,Ye)):(m(),v(H,{key:1,size:"lg",name:"account_circle"}))]),_:2},1024)]),_:2},1024),e(x,null,{default:a(()=>[e(G,null,{default:a(()=>[g(F(T(c)),1)]),_:2},1024),e(G,{caption:""},{default:a(()=>[g(F(c.email),1)]),_:2},1024)]),_:2},1024),e(x,{side:""},{default:a(()=>[o.value==="all"?(m(),v(G,{key:0},{default:a(()=>[g(F(f(c)),1)]),_:2},1024)):(m(),v(G,{key:1},{default:a(()=>[e(b,{onClick:ve(M=>z(o.value,c),["stop"]),color:"negative",size:"sm",icon:"close",round:"",flat:""},null,8,["onClick"])]),_:2},1024))]),_:2},1024),e(_e,{anchor:"bottom middle",self:"top middle"},{default:a(()=>[e(ae,null,{default:a(()=>[S((m(),v(N,{onClick:M=>Y(c.email),clickable:""},{default:a(()=>[e(x,null,{default:a(()=>[g("Добавить тренировку")]),_:1})]),_:2},1032,["onClick"])),[[j]]),f(c)==="Без группы"?S((m(),v(N,{key:0,disable:Object.values(J(n).groups).length===0,onClick:M=>t(c.email),clickable:""},{default:a(()=>[e(x,null,{default:a(()=>[g("Добавить в группу")]),_:1})]),_:2},1032,["disable","onClick"])),[[j]]):ee("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[ge]])),128))]),_:1}),e(P,{class:"bg-transparent",flat:""},{default:a(()=>[e(E,{class:"row q-pa-none"},{default:a(()=>[o.value==="all"?(m(),v(b,{key:0,onClick:R,color:"secondary","text-color":"positive",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Командная тренировка ")]),_:1})):(m(),$(O,{key:1},[e(b,{onClick:y[1]||(y[1]=c=>B(o.value)),color:"secondary","text-color":"positive",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Групповая тренировка ")]),_:1}),e(b,{onClick:s,color:"secondary","text-color":"info",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Добавить в группу ")]),_:1}),e(b,{onClick:y[2]||(y[2]=c=>D(o.value)),color:"secondary","text-color":"negative",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Удалить группу ")]),_:1})],64))]),_:1})]),_:1})])])],64)):(m(),v(Ve,{key:1}))]),_:1}))}}),ma=h(Be,[["__file","TeamPage.vue"]]);export{ma as default};
