import{u as re,a as ue,b as ie,Q as de}from"./QTabs-O2W2XSBW.js";import{C as se,h as me,d as S,r as T,l as m,m as v,n as a,p as _,f as e,t as N,Q as C,U as P,v as b,x as g,an as A,A as G,_ as h,c as q,R as H,a6 as I,o as ce,Y as pe,ao as J,ap as $,F as M,aq as X,ar as ee,as as fe,at as F,S as ve,au as ge}from"./index-BFn0Cppg.js";import{Q as be}from"./QToolbar-DYr7dOmz.js";import{Q as U,a as x,b as O}from"./QItemLabel-DuN-C2zx.js";import{Q as ae}from"./QList-G-kWHoEk.js";import{Q as _e}from"./QMenu-oS6U-ARc.js";import{Q as ke}from"./QPage-DK4_fnuy.js";import{u as ne,Q as oe,a as ye,T as le,C as j}from"./useWorkoutStore-CMd5UBAH.js";import{I as Te}from"./InnerLoading-CKNWaYoG.js";import{Q as L}from"./QForm-DFIZr3sv.js";import{u as Q,a as Ve}from"./use-quasar-DjEifxil.js";import{Q as W}from"./QSelect-C2lEpXG8.js";import{u as Z,Q as we}from"./QDate-BrhryQkz.js";import"./QResizeObserver-CXlURMH1.js";import"./selection-BQXeflt9.js";import"./TouchPan-Bhvho9XY.js";import"./date-DdmoPL0X.js";import"./format-Dumr6BwO.js";import"./QChip-B2Pt8srd.js";const Qe=se({name:"QTab",props:re,emits:ue,setup(w,{slots:r,emit:k}){const{renderTab:n}=ie(w,r,k);return()=>n("div")}}),qe=me("div",{class:"q-space"}),$e=se({name:"QSpace",setup(){return()=>qe}}),xe={class:"card-container card-container--sm bg-dark q-pa-md"},Ie=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Добавление спортсмена",-1),Se=S({__name:"TeamSportsmanModal",emits:Q.emits,setup(w){const{dialogRef:r,onDialogOK:k}=Q(),n=T(""),d=T(!1),o=T(null);async function p(){d.value=!0,await G.addSportsman({email:n.value}),d.value=!1,k()}return(V,f)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:r},{default:a(()=>[_("div",xe,[e(L,{onSubmit:p},{default:a(()=>[Ie,e(N,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=i=>n.value=i),rules:[i=>!!i||"Поле обязательно для заполнения",i=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(i)||"Некорректный email"],onKeydown:f[1]||(f[1]=i=>o.value.resetValidation()),onBlur:f[2]||(f[2]=i=>o.value.validate()),autocapitalize:"off",label:"Почта спортсмена",type:"email",inputmode:"email",ref_key:"emailInput",ref:o,class:"q-mb-sm","lazy-rules":"",outlined:"",autofocus:""},null,8,["modelValue","rules"]),e(C,{class:"bg-transparent",flat:""},{default:a(()=>[e(P,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:d.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Применить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),Ce=h(Se,[["__file","TeamSportsmanModal.vue"]]),Pe={class:"card-container card-container--sm bg-dark q-pa-md"},he=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Добавление группы",-1),De=S({__name:"TeamGroupModal",emits:Q.emits,setup(w){const{dialogRef:r,onDialogOK:k}=Q(),n=Z(),d=T({name:"",sportsmansEmails:[]}),o=T(!1),p=T(null),V=q(()=>n.team?Object.values(n.team?.sportsmans).map(i=>({label:`${i.middleName} ${i.firstName} ${i.lastName}`,value:i.email})):[]);async function f(){o.value=!0;const i=await n.createGroup(d.value);o.value=!1,i&&k(i)}return(i,l)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:r},{default:a(()=>[_("div",Pe,[e(L,{onSubmit:f},{default:a(()=>[he,e(N,{modelValue:d.value.name,"onUpdate:modelValue":l[0]||(l[0]=t=>d.value.name=t),rules:[t=>!!t||"Поле обязательно для заполнения"],onKeydown:l[1]||(l[1]=t=>p.value.resetValidation()),onBlur:l[2]||(l[2]=t=>p.value.validate()),label:"Название группы",ref_key:"nameInput",ref:p,class:"q-mb-md","hide-bottom-space":"","lazy-rules":"",outlined:""},null,8,["modelValue","rules"]),e(W,{modelValue:d.value.sportsmansEmails,"onUpdate:modelValue":l[3]||(l[3]=t=>d.value.sportsmansEmails=t),options:V.value,label:"Список спортсменов",class:"q-mb-md","use-chips":"",multiple:"","map-options":"","emit-value":"",outlined:""},{"no-option":a(()=>[e(U,null,{default:a(()=>[e(x,{class:"text-italic text-grey"},{default:a(()=>[g(" Список для добавления пуст ")]),_:1})]),_:1})]),_:1},8,["modelValue","options"]),e(C,{class:"bg-transparent",flat:""},{default:a(()=>[e(P,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:o.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Добавить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),Ee=h(De,[["__file","TeamGroupModal.vue"]]),Me={class:"card-container card-container--sm bg-dark q-pa-md"},Oe=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Добавление спортсменов",-1),Ge=S({__name:"TeamAddToGroupModal",props:{sportsmansEmails:{},groupId:{}},emits:Q.emits,setup(w){const r=w,{dialogRef:k,onDialogOK:n}=Q(),d=Z(),o=T({sportsmansEmails:r.sportsmansEmails||[],groupId:r.groupId||""}),p=T(!1),V=q(()=>d.groups?Object.values(d.groups).map(l=>({label:l.name,value:l.id})):[]),f=q(()=>d.team?Object.values(d.team?.sportsmans).filter(l=>!d.groups[o.value.groupId]?.sportsmans[l.id]).map(l=>({label:`${l.middleName} ${l.firstName} ${l.lastName}`,value:l.email})):[]);async function i(){p.value=!0,await d.addSportsmanToGroup(o.value),p.value=!1,n()}return(l,t)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:k},{default:a(()=>[_("div",Me,[e(L,{onSubmit:i},{default:a(()=>[Oe,e(W,{modelValue:o.value.groupId,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.groupId=s),options:V.value,disable:!!l.groupId,label:"Группа",class:"q-mb-md",outlined:"","map-options":"","emit-value":""},null,8,["modelValue","options","disable"]),e(W,{modelValue:o.value.sportsmansEmails,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.sportsmansEmails=s),options:f.value,disable:!!l.sportsmansEmails,"use-chips":!l.sportsmansEmails,label:l.sportsmansEmails?"Спортсмен":"Список спортсменов",class:"q-mb-md",outlined:"",multiple:"","map-options":"","emit-value":""},null,8,["modelValue","options","disable","use-chips","label"]),e(C,{class:"bg-transparent",flat:""},{default:a(()=>[e(P,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:p.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Добавить ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),te=h(Ge,[["__file","TeamAddToGroupModal.vue"]]),Ue={class:"card-container card-container--sm bg-dark q-pa-md"},Ne=_("h5",{class:"text-center q-mt-xs q-mb-lg"},"Создание тренировки",-1),je={class:"row items-center justify-end"},We={class:"row items-center justify-end"},Ae=S({__name:"TeamWorkoutModal",props:{sportsmanEmail:{},groupId:{}},emits:Q.emits,setup(w){const r=w,{dialogRef:k,onDialogOK:n}=Q(),d=ne(),o=T({workoutPoolId:"",date:"",restTime:0,stressQuestionnaireTime:0}),p=T(!1),V=q(()=>r.sportsmanEmail?"Индивидуальная":r.groupId?"Групповая":"Командная"),f=q(()=>d.workoutsPool?Object.values(d.workoutsPool).map(l=>({label:l.name,value:l.id})):[]);async function i(){p.value=!0;const l=new Date,[t,s]=o.value.date.split(" "),[D,R,Y]=t.split("."),[z,B]=s.split(":");l.setFullYear(+Y,+R-1,+D),l.setHours(+z,+B),l.setSeconds(0);const u={...o.value,date:l.toISOString().slice(0,-1)};r.sportsmanEmail?await G.createSportsmanWorkout({...u,sportsmanEmail:r.sportsmanEmail}):r.groupId?await G.createGroupWorkout({...u,groupId:r.groupId}):await G.createTeamWorkout(u),n()}return(l,t)=>(m(),v(A,{"no-backdrop-dismiss":!1,ref_key:"dialogRef",ref:k},{default:a(()=>[_("div",Ue,[Ne,e(L,{onSubmit:i},{default:a(()=>[e(N,{"model-value":V.value,label:"Тип тренировки",class:"q-mb-md",outlined:"",readonly:""},null,8,["model-value"]),e(W,{modelValue:o.value.workoutPoolId,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.workoutPoolId=s),options:f.value,rules:[s=>!!s||"Обязательное поле"],label:"Тренировка",class:"q-mb-md","hide-bottom-space":"",outlined:"","map-options":"","emit-value":""},null,8,["modelValue","options","rules"]),e(N,{modelValue:o.value.date,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.date=s),rules:[s=>/^[0-9]{2}\.[0-9]{2}\.[0-9]{4} [0-9]{2}:[0-9]{2}$/.test(s)||"Некорректная дата",s=>!!s||"Обязательное поле"],label:"Дата и время начала тренировки",class:"q-mb-md","hide-bottom-space":"",outlined:""},{prepend:a(()=>[e(H,{name:"event",class:"cursor-pointer"},{default:a(()=>[e(oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(we,{modelValue:o.value.date,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.date=s),options:s=>new Date<new Date(s),mask:"DD.MM.YYYY HH:mm",color:"secondary"},{default:a(()=>[_("div",je,[I(e(b,{label:"Закрыть","no-caps":"",flat:""},null,512),[[j]])])]),_:1},8,["modelValue","options"])]),_:1})]),_:1})]),append:a(()=>[e(H,{name:"access_time",class:"cursor-pointer"},{default:a(()=>[e(oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(ye,{modelValue:o.value.date,"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.date=s),mask:"DD.MM.YYYY HH:mm",color:"secondary",format24h:""},{default:a(()=>[_("div",We,[I(e(b,{label:"Закрыть","no-caps":"",flat:""},null,512),[[j]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),e(le,{modelValue:o.value.restTime,"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.restTime=s),label:"Время отдыха после тренировки",class:"q-mb-md"},null,8,["modelValue"]),e(le,{modelValue:o.value.stressQuestionnaireTime,"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.stressQuestionnaireTime=s),label:"Время для нагрузочного опросника",class:"q-mb-md"},null,8,["modelValue"]),e(C,{class:"bg-transparent",flat:""},{default:a(()=>[e(P,{class:"row q-pa-none"},{default:a(()=>[e(b,{loading:p.value,type:"submit","text-color":"positive",color:"secondary",class:"col border-radius-8",padding:"md lg",style:{"line-height":"21px"},"no-caps":""},{default:a(()=>[g(" Создать ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})])]),_:1},512))}}),K=h(Ae,[["__file","TeamWorkoutModal.vue"]]),Le={class:"row items-center justify-around full-width"},Re={class:"card-container column"},Ye={key:0,class:"text-center q-mt-xs q-mb-none"},ze=["src"],Be=S({__name:"TeamPage",setup(w){const r=Ve(),k=ne(),n=Z(),d=q(()=>[{label:"Все спортсмены",value:"all"},...Object.values(n.groups).map(u=>({label:u.name,value:u.id}))]),o=T("all"),p=q(()=>n.team?o.value==="all"?n.team.sportsmans:n.groups[o.value]?n.groups[o.value].sportsmans:{}:{});function V(u){return`${u.middleName} ${u.firstName} ${u.lastName}`}function f(u){return Object.values(n.groups).find(y=>y.sportsmans[u.id])?.name||"Без группы"}function i(){r.dialog({component:Ce})}function l(){r.dialog({component:Ee}).onOk(u=>{o.value=u})}function t(u){r.dialog({component:te,componentProps:{sportsmansEmails:[u]}})}function s(){r.dialog({component:te,componentProps:{groupId:o.value}})}function D(u){r.dialog({title:"Удалить группу?",message:"Группа будет удалена без возможности восстановления",persistent:!0,ok:{color:"negative",label:"Удалить",noCaps:!0},cancel:{color:"secondary",label:"Отменить",noCaps:!0}}).onOk(()=>{n.deleteGroup(u),o.value="all"})}function R(u,y){r.dialog({title:"Удалить из группы?",message:`Вы уверены, что хотите удалить ${V(y)} из группы?`,persistent:!0,ok:{color:"negative",label:"Удалить",noCaps:!0},cancel:{color:"secondary",label:"Отменить",noCaps:!0}}).onOk(()=>{n.deleteFromGroup(u,y.email)})}function Y(){r.dialog({component:K})}function z(u){r.dialog({component:K,componentProps:{sportsmanEmail:u}})}function B(u){r.dialog({component:K,componentProps:{groupId:u}})}return ce(async()=>{await k.loadWorkoutData(),await n.loadPage()}),pe(()=>{n.isPageLoaded=!1}),(u,y)=>(m(),v(ke,{class:"column items-center",padding:""},{default:a(()=>[J(n).isPageLoaded?(m(),$(M,{key:0},[e(be,{class:"bg-secondary text-white q-mb-md"},{default:a(()=>[e(de,{modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=c=>o.value=c),class:"q-ml-xs","inline-label":""},{default:a(()=>[(m(!0),$(M,null,X(d.value,(c,E)=>(m(),v(Qe,{key:E,label:c.label,name:c.value,"no-caps":""},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),e($e),e(b,{onClick:l,color:"info",label:"Добавить группу","icon-right":"group_add",class:"q-mr-sm","no-caps":"",flat:""}),e(b,{onClick:i,label:"Добавить спортсмена",color:"positive","icon-right":"person_add","no-caps":""})]),_:1}),_("div",Le,[_("div",Re,[Object.values(p.value).length===0?(m(),$("h5",Ye," Список спортсменов пуст ")):ee("",!0),e(ae,{class:"bg-secondary border-radius-8 overflow-hidden q-mb-md",separator:""},{default:a(()=>[(m(!0),$(M,null,X(p.value,c=>I((m(),v(U,{key:c.id,clickable:""},{default:a(()=>[e(x,{avatar:""},{default:a(()=>[e(fe,null,{default:a(()=>[c.avatarUri?(m(),$("img",{key:0,src:c.avatarUri},null,8,ze)):(m(),v(H,{key:1,size:"lg",name:"account_circle"}))]),_:2},1024)]),_:2},1024),e(x,null,{default:a(()=>[e(O,null,{default:a(()=>[g(F(V(c)),1)]),_:2},1024),e(O,{caption:""},{default:a(()=>[g(F(c.email),1)]),_:2},1024)]),_:2},1024),e(x,{side:""},{default:a(()=>[o.value==="all"?(m(),v(O,{key:0},{default:a(()=>[g(F(f(c)),1)]),_:2},1024)):(m(),v(O,{key:1},{default:a(()=>[e(b,{onClick:ve(E=>R(o.value,c),["stop"]),color:"negative",size:"sm",icon:"close",round:"",flat:""},null,8,["onClick"])]),_:2},1024))]),_:2},1024),e(_e,{anchor:"bottom middle",self:"top middle"},{default:a(()=>[e(ae,null,{default:a(()=>[I((m(),v(U,{onClick:E=>z(c.email),clickable:""},{default:a(()=>[e(x,null,{default:a(()=>[g("Добавить тренировку")]),_:1})]),_:2},1032,["onClick"])),[[j]]),f(c)==="Без группы"?I((m(),v(U,{key:0,disable:Object.values(J(n).groups).length===0,onClick:E=>t(c.email),clickable:""},{default:a(()=>[e(x,null,{default:a(()=>[g("Добавить в группу")]),_:1})]),_:2},1032,["disable","onClick"])),[[j]]):ee("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[ge]])),128))]),_:1}),e(C,{class:"bg-transparent",flat:""},{default:a(()=>[e(P,{class:"row q-pa-none"},{default:a(()=>[o.value==="all"?(m(),v(b,{key:0,onClick:Y,color:"secondary","text-color":"positive",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Командная тренировка ")]),_:1})):(m(),$(M,{key:1},[e(b,{onClick:y[1]||(y[1]=c=>B(o.value)),color:"secondary","text-color":"positive",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Групповая тренировка ")]),_:1}),e(b,{onClick:s,color:"secondary","text-color":"info",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Добавить в группу ")]),_:1}),e(b,{onClick:y[2]||(y[2]=c=>D(o.value)),color:"secondary","text-color":"negative",class:"col border-radius-8",padding:"md lg","no-caps":""},{default:a(()=>[g(" Удалить группу ")]),_:1})],64))]),_:1})]),_:1})])])],64)):(m(),v(Te,{key:1}))]),_:1}))}}),pa=h(Be,[["__file","TeamPage.vue"]]);export{pa as default};
